#!/bin/bash

echo
echo "Homebridge plugin install script."
echo

if [ "$(id -u)" != "0" ]; then
   echo "This script must be run with sudo. Use \"sudo ${0} ${*}\"" 1>&2
   exit 1
fi

# homebridge-nature-remo-sensor
sudo npm install -g homebridge-nature-remo-sensor -g

# homebridge-nature-remo-aircon
# https://github.com/kmaehashi/homebridge-nature-remo-aircon
NATURE_REMO_AIRCON_TMP_DIR=/tmp/homebridge-nature-remo-aircon
NATURE_REMO_AIRCON_PACKAGE=homebridge-nature-remo-aircon-1.0.0.tgz
git clone https://github.com/kmaehashi/homebridge-nature-remo-aircon.git ${NATURE_REMO_AIRCON_TMP_DIR}
npm pack --cwd ${NATURE_REMO_AIRCON_TMP_DIR} && mv ${NATURE_REMO_AIRCON_PACKAGE} ${NATURE_REMO_AIRCON_TMP_DIR}/
sudo npm install -g ${NATURE_REMO_AIRCON_TMP_DIR}/${NATURE_REMO_AIRCON_PACKAGE}
rm -rf ${NATURE_REMO_AIRCON_TMP_DIR}

source restart